<!DOCTYPE html>
<html lang="de">
<!-- Der HTML-Teil und CSS bleiben gleich -->
<head>
    <!-- Ihr vorhandener Head-Bereich -->
</head>
<body>
    <!-- Ihr vorhandener HTML-Körper -->
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Variablen und DOM-Elemente wie zuvor
            
            // Dateinamen - Änderung des ersten Dateinamens, falls er möglicherweise falsch ist
            const files = [
                'Coded_Verbs.txt',   // Geändert von Coded_Verb.txt zu Coded_Verbs.txt
                'Coded_Verbs_B.txt'  // Zweite Datei bleibt unverändert
            ];
            
            // Laden aller Daten
            async function initSystem() {
                loadingIndicator.style.display = 'block';
                loadingIndicator.textContent = 'Lade Daten...';
                
                try {
                    // Sammle alle Daten aus allen Dateien
                    let allData = '';
                    let loadedFiles = 0;
                    
                    // Dateien nacheinander laden mit mehr Debugging-Informationen
                    for (let i = 0; i < files.length; i++) {
                        const fileName = files[i];
                        loadingIndicator.textContent = `Lade Datei ${i+1} von ${files.length}: ${fileName}...`;
                        console.log(`Versuche Datei ${fileName} zu laden...`);
                        
                        try {
                            // Datei laden mit Timeout und Fehlerbehandlung
                            const text = await fetchWithRetry(fileName, 3); // 3 Versuche
                            
                            if (text && text.trim()) {
                                console.log(`Datei ${fileName} erfolgreich geladen. Länge: ${text.length} Zeichen`);
                                // Prüfen, ob die Datei als Text geladen wurde
                                console.log(`Erster Abschnitt der Datei ${fileName}:`, text.substring(0, 100));
                                
                                allData += (allData ? '\n\n' : '') + text;
                                loadedFiles++;
                            } else {
                                console.warn(`Datei ${fileName} wurde geladen, ist aber leer oder ungültig.`);
                                showError(`Warnung: Datei ${fileName} enthält keine Daten.`);
                            }
                        } catch (fileError) {
                            console.error(`Fehler beim Laden der Datei ${fileName}:`, fileError);
                            showError(`Fehler beim Laden der Datei ${fileName}: ${fileError.message}`);
                        }
                    }
                    
                    // Zusätzliche Checks, wie viele Dateien geladen wurden
                    console.log(`${loadedFiles} von ${files.length} Dateien wurden geladen.`);
                    
                    if (!allData) {
                        throw new Error("Keine Daten konnten geladen werden.");
                    }
                    
                    // Verarbeite die gesammelten Daten
                    loadingIndicator.textContent = 'Verarbeite Daten...';
                    processVerbFile(allData);
                    
                    // Zeige den ersten Eintrag, wenn verfügbar
                    if (verbEntries.length > 0) {
                        displayEntry(0);
                    }
                    
                    // Aktualisiere Navigationselemente
                    updateNavButtons();
                    
                } catch (error) {
                    console.error("Fehler beim Initialisieren:", error);
                    showError("Fehler beim Laden der Daten: " + error.message);
                } finally {
                    loadingIndicator.style.display = 'none';
                }
            }
            
            // Fetch mit Wiederholungsversuchen
            async function fetchWithRetry(resource, maxRetries = 3) {
                let lastError;
                
                for (let attempt = 1; attempt <= maxRetries; attempt++) {
                    try {
                        console.log(`Versuch ${attempt} von ${maxRetries} für ${resource}`);
                        const response = await fetch(resource, {
                            cache: 'no-store' // Ignoriert den Cache, lädt immer neu
                        });
                        
                        if (!response.ok) {
                            throw new Error(`HTTP Fehler ${response.status}`);
                        }
                        
                        return await response.text();
                    } catch (error) {
                        console.warn(`Fehler bei Versuch ${attempt}:`, error);
                        lastError = error;
                        
                        // Kurze Pause vor dem nächsten Versuch
                        if (attempt < maxRetries) {
                            await new Promise(resolve => setTimeout(resolve, 1000));
                        }
                    }
                }
                
                throw new Error(`Nach ${maxRetries} Versuchen gescheitert: ${lastError.message}`);
            }
            
            // Der Rest des Codes bleibt größtenteils unverändert
            // ...
        });
    </script>
</body>
</html>